# おじさん言語 完全リファレンス

おじさん言語は、おじさんLINE風の日本語構文で記述するプログラミング言語です。
ファイル拡張子は `.ojs`（スクリプト）または `.oji`（インタラクティブ）です。

---

## 目次

1. [基本](#1-基本)
2. [データ型とリテラル](#2-データ型とリテラル)
3. [変数](#3-変数)
4. [演算子](#4-演算子)
5. [出力](#5-出力)
6. [制御構文](#6-制御構文)
7. [関数](#7-関数)
8. [クラス](#8-クラス)
9. [配列](#9-配列)
10. [辞書](#10-辞書)
11. [例外処理](#11-例外処理)
12. [モジュール（import）](#12-モジュールimport)
13. [組み込み関数](#13-組み込み関数)
14. [コメント](#14-コメント)
15. [文字列エスケープ](#15-文字列エスケープ)

---

## 1. 基本

### 実行

```bash
ojisan スクリプト.ojs
ojisan スクリプト.oji
```

`.ojs` または `.oji` 以外の拡張子は実行できません。

### REPLモード

```bash
ojisan
```

引数なしで起動すると対話モードに入ります。

---

## 2. データ型とリテラル

| 型 | リテラル例 | 説明 |
|---|---|---|
| 整数 | `42`, `0`, `マイナス 5` | 64bit整数 |
| 浮動小数点 | `3.14`, `マイナス 0.5` | 64bit倍精度 |
| 文字列 | `「こんにちは」` | 「」で囲む。UTF-8対応 |
| 真偽値 | `マジ`, `ウソ` | true / false |
| null | `ナイナイ` | 値なし |
| 配列 | `【1、 2、 3】` | 【】で囲み、読点で区切る |
| 辞書 | `《「名前」→「太郎」、「年齢」→30》` | 《》で囲み、→でキーと値を対応 |

### 単項マイナス

数値リテラルの前に `マイナス` をつけると符号を反転します。

```
マイナス 5        （→ -5）
マイナス 3.14     （→ -3.14）
マイナス マイナス 10  （→ 10  ※二重否定）
```

---

## 3. 変数

### 宣言

```
チョット聞いてヨ😃 名前チャンは 「おじさん」 ナンダ😘
チョット聞いてヨ😃 年齢チャンは 45 ナンダ😘
チョット聞いてヨ😃 配列チャンは 【1、 2、 3】 ナンダ😘
```

**構文:** `チョット聞いてヨ😃 <変数名>チャンは <式> ナンダ😘`

### 代入

```
年齢チャンは 46 ニナッチャッタ😅💦
```

**構文:** `<変数名>チャンは <式> ニナッチャッタ😅💦`

### 参照

変数名の後に `チャン` をつけて参照します。

```
年齢チャン オッハー❗
```

---

## 4. 演算子

### 演算子一覧（優先順位: 上が低、下が高）

| 優先順位 | 演算子 | 意味 | 例 |
|---|---|---|---|
| 1（最低） | `もしくは` | 論理OR | `aチャン もしくは bチャン` |
| 2 | `しかも` | 論理AND | `aチャン しかも bチャン` |
| 3 | `おなじカナ❓` | 等価 (==) | `aチャン おなじカナ❓ bチャン` |
| 3 | `ちがうカナ❓` | 不等価 (!=) | `aチャン ちがうカナ❓ bチャン` |
| 4 | `より上❗` | 大なり (>) | `aチャン より上❗ bチャン` |
| 4 | `より下❗` | 小なり (<) | `aチャン より下❗ bチャン` |
| 4 | `以上❗` | 以上 (>=) | `aチャン 以上❗ bチャン` |
| 4 | `以下❗` | 以下 (<=) | `aチャン 以下❗ bチャン` |
| 5 | `と` | 加算 / 文字列結合 | `aチャン と bチャン` |
| 5 | `ひく` | 減算 | `aチャン ひく bチャン` |
| 6 | `かける` | 乗算 | `aチャン かける bチャン` |
| 6 | `わる` | 除算 | `aチャン わる bチャン` |
| 6 | `あまり` | 剰余 | `aチャン あまり bチャン` |
| 7 | `マイナス` | 単項マイナス | `マイナス aチャン` |
| 7 | `チガウヨ` | 論理NOT | `チガウヨ aチャン` |
| 8（最高） | `の` | プロパティ/メソッド | `objチャンの 名前チャン` |

### 文字列結合

`と` 演算子は文字列同士の結合にも使えます。数値と文字列を `と` で繋ぐと自動的に文字列に変換されます。

```
「おじさんは」 と 45 と 「歳ダヨ」 オッハー❗
```

### グルーピング

`( )` で式をグルーピングできます。

```
チョット聞いてヨ😃 結果チャンは (aチャン と bチャン) かける cチャン ナンダ😘
```

---

## 5. 出力

### 改行あり出力

```
「Hello World」 オッハー❗
42 オッハー❗
変数チャン オッハー❗
```

**構文:** `<式> オッハー❗`

### 改行なし出力

```
「名前: 」 ツブヤキ📱
名前チャン オッハー❗
```

**構文:** `<式> ツブヤキ📱`

---

## 6. 制御構文

### if文

```
もしかして😍 xチャン より上❗ 10 カナ❓
    「大きい」 オッハー❗
オッケー👍
```

### if-else文

```
もしかして😍 xチャン より上❗ 10 カナ❓
    「大きい」 オッハー❗
ソウジャナカッタラ😅
    「小さい」 オッハー❗
オッケー👍
```

### if-else if-else文

```
もしかして😍 xチャン より上❗ 100 カナ❓
    「とても大きい」 オッハー❗
ナンチャッテ😃 xチャン より上❗ 10 カナ❓
    「大きい」 オッハー❗
ソウジャナカッタラ😅
    「小さい」 オッハー❗
オッケー👍
```

**構文:**
```
もしかして😍 <条件> カナ❓
    <本体>
[ナンチャッテ😃 <条件> カナ❓
    <本体>]*
[ソウジャナカッタラ😅
    <本体>]
オッケー👍
```

### whileループ

```
チョット聞いてヨ😃 iチャンは 0 ナンダ😘
気になるんだけど😚 iチャン より下❗ 10 の間はネ😘
    iチャン オッハー❗
    iチャンは iチャン と 1 ニナッチャッタ😅💦
もういいカナ😤
```

**構文:** `気になるんだけど😚 <条件> の間はネ😘 <本体> もういいカナ😤`

### for範囲ループ

```
iチャンが 1 から 10 まで関係あるんだけどサ😁
    iチャン オッハー❗
もういいカナ😤
```

**構文:** `<変数>チャンが <開始> から <終了> まで関係あるんだけどサ😁 <本体> もういいカナ😤`

開始値 > 終了値の場合は自動的に降順ループになります。

### for-eachループ

```
チョット聞いてヨ😃 リストチャンは 【「りんご」、「バナナ」、「みかん」】 ナンダ😘
要素チャンが リストチャン のメンバーなんだけどサ😁
    要素チャン オッハー❗
もういいカナ😤
```

**構文:** `<変数>チャンが <コレクション> のメンバーなんだけどサ😁 <本体> もういいカナ😤`

配列と辞書の両方に対応しています。辞書の場合はキーがループ変数に入ります。

### break / continue

```
iチャンが 1 から 100 まで関係あるんだけどサ😁
    もしかして😍 iチャン おなじカナ❓ 50 カナ❓
        もうムリ😱💦
    オッケー👍
    もしかして😍 iチャン あまり 2 おなじカナ❓ 0 カナ❓
        次イコウヨ😃
    オッケー👍
    iチャン オッハー❗
もういいカナ😤
```

- `もうムリ😱💦` — ループを脱出（break）
- `次イコウヨ😃` — 次のイテレーションへ（continue）

---

## 7. 関数

### 定義

```
挨拶チャンのやり方教えるネ😘 名前チャン
    「こんにちは、」 と 名前チャン オッハー❗
やり方おしまい❗
```

**構文:** `<関数名>チャンのやり方教えるネ😘 [<引数>チャン、 ...]  <本体> やり方おしまい❗`

### 呼び出し

```
挨拶チャンにオネガイ😃 「おじさん」
```

**構文:** `<関数名>チャンにオネガイ😃 [<引数1>、 <引数2>、 ...]`

### 戻り値

```
足し算チャンのやり方教えるネ😘 aチャン、 bチャン
    コタエは aチャン と bチャン ダヨ😁
やり方おしまい❗

チョット聞いてヨ😃 結果チャンは 足し算チャンにオネガイ😃 3、 5 ナンダ😘
結果チャン オッハー❗
```

**構文:** `コタエは <式> ダヨ😁`

### 戻り値を変数に格納

```
チョット聞いてヨ😃 結果チャンは 関数チャンにオネガイ😃 引数 ナンダ😘
```

---

## 8. クラス

### 定義

```
犬サンのコト教えるヨ😃
    ハジメマシテ😘 名前チャン、 年齢チャン
        ボクの 名前チャンは 名前チャン ニナッチャッタ😅💦
        ボクの 年齢チャンは 年齢チャン ニナッチャッタ😅💦
    ハジメマシテおしまい❗

    自己紹介チャンのやり方教えるネ😘
        「ボクは」 と ボクの 名前チャン と 「、」 と ボクの 年齢チャン と 「歳ダヨ」 オッハー❗
    やり方おしまい❗
犬サンのコトおしまい❗
```

**構文:**
```
<クラス名>サンのコト教えるヨ😃
    [ハジメマシテ😘 [<引数>チャン、 ...]
        <コンストラクタ本体>
    ハジメマシテおしまい❗]

    [<メソッド名>チャンのやり方教えるネ😘 [<引数>チャン、 ...]
        <メソッド本体>
    やり方おしまい❗]*
<クラス名>サンのコトおしまい❗
```

### インスタンス生成

```
チョット聞いてヨ😃 ポチチャンは 犬サンを作るヨ😃 「ポチ」、 3 ナンダ😘
```

**構文:** `<クラス名>サンを作るヨ😃 [<引数1>、 <引数2>、 ...]`

### プロパティアクセス

```
ポチチャンの 名前チャン オッハー❗
```

**構文:** `<オブジェクト>チャンの <プロパティ>チャン`

### メソッド呼び出し

```
ポチチャンの 自己紹介チャンにオネガイ😃
```

**構文:** `<オブジェクト>チャンの <メソッド>チャンにオネガイ😃 [<引数>、 ...]`

### thisアクセス

メソッド・コンストラクタ内で `ボクの` を使ってフィールドにアクセスします。

```
ボクの 名前チャン          （読み取り）
ボクの 名前チャンは 値 ニナッチャッタ😅💦  （書き込み）
```

---

## 9. 配列

### 生成

```
チョット聞いてヨ😃 果物チャンは 【「りんご」、「バナナ」、「みかん」】 ナンダ😘
```

### アクセス（0始まり）

```
果物チャンの 0 番目チャン オッハー❗
果物チャンの iチャン 番目チャン オッハー❗
```

**構文:** `<配列>チャンの <インデックス> 番目チャン`

### 要素代入

```
果物チャンの 0 番目チャンは 「ぶどう」 ニナッチャッタ😅💦
```

**構文:** `<配列>チャンの <インデックス> 番目チャンは <値> ニナッチャッタ😅💦`

### 要素追加（push）

```
果物チャンに 「メロン」 を追加ダヨ😁
```

**構文:** `<配列>チャンに <値> を追加ダヨ😁`

### 長さ

```
果物チャンの長さチャン オッハー❗
```

---

## 10. 辞書

### 生成

```
チョット聞いてヨ😃 人チャンは 《「名前」→「おじさん」、「年齢」→45》 ナンダ😘
```

**構文:** `《 <キー1> → <値1>、 <キー2> → <値2>、 ... 》`

### アクセス

```
人チャンの「名前」番目チャン オッハー❗
```

**構文:** `<辞書>チャンの <キー> 番目チャン`

### 要素代入

```
人チャンの「住所」番目チャンは 「東京」 ニナッチャッタ😅💦
```

### for-eachで列挙

```
キーチャンが 人チャン のメンバーなんだけどサ😁
    キーチャン オッハー❗
もういいカナ😤
```

---

## 11. 例外処理

### try-catch

```
ドキドキするけど😅💦
    （ココだけの話…危険な処理）
    チョット聞いてヨ😃 結果チャンは 0 わる 0 ナンダ😘
ヤバかった😱 エラーチャン
    「エラー発生: 」 と エラーチャン オッハー❗
ドキドキおしまい❗
```

### try-catch-finally

```
ドキドキするけど😅💦
    （ココだけの話…危険な処理）
ヤバかった😱 エラーチャン
    「エラー: 」 と エラーチャン オッハー❗
ドッチニシテモ😤
    「後処理完了」 オッハー❗
ドキドキおしまい❗
```

**構文:**
```
ドキドキするけど😅💦
    <try本体>
[ヤバかった😱 <エラー変数>チャン
    <catch本体>]
[ドッチニシテモ😤
    <finally本体>]
ドキドキおしまい❗
```

---

## 12. モジュール（import）

### 外部ファイルの読み込み

```
取り寄せてヨ😃 「lib/utils.ojs」
```

**構文:** `取り寄せてヨ😃 「<ファイルパス>」`

- `.ojs` または `.oji` ファイルのみインポート可能
- 同じファイルの二重インポートは自動的にスキップ
- インポートしたファイル内の関数・変数は現在のスコープに追加される
- パスはカレントディレクトリからの相対パス

### 使用例

**lib/math.ojs:**
```
二倍チャンのやり方教えるネ😘 nチャン
    コタエは nチャン かける 2 ダヨ😁
やり方おしまい❗
```

**main.ojs:**
```
取り寄せてヨ😃 「lib/math.ojs」
チョット聞いてヨ😃 結果チャンは 二倍チャンにオネガイ😃 21 ナンダ😘
結果チャン オッハー❗
```

---

## 13. 組み込み関数

組み込み関数は `<関数名>チャンにオネガイ😃 引数` で呼び出します。

### 入出力

| 関数名 | 引数 | 戻り値 | 説明 |
|---|---|---|---|
| `チョット教えてヨ😃` | (プロンプト) | 文字列 | 標準入力から1行読み込み |
| `表示チャン😃` | (値1, 値2, ...) | ナイナイ | スペース区切りで出力（改行あり） |

### 型変換

| 関数名 | 引数 | 戻り値 | 説明 |
|---|---|---|---|
| `文字にしてネ😘` | (値) | 文字列 | 値を文字列に変換 |
| `数字にしてネ😘` | (文字列) | 数値 | 文字列を数値に変換（整数/小数自動判定） |
| `整数にしてネ😘` | (値) | 整数 | 整数に変換（小数は切り捨て） |
| `型を教えてヨ😃` | (値) | 文字列 | 型名を返す |
| `長さを教えてヨ😃` | (文字列/配列) | 整数 | 文字列のバイト長 / 配列の要素数 |

### 数学

| 関数名 | 引数 | 戻り値 | 説明 |
|---|---|---|---|
| `切り捨てチャン😃` | (数値) | 数値 | floor — 小数切り捨て |
| `切り上げチャン😃` | (数値) | 数値 | ceil — 小数切り上げ |
| `四捨五入チャン😃` | (数値) | 数値 | round — 四捨五入 |
| `絶対値チャン😃` | (数値) | 数値 | abs — 絶対値 |
| `最大チャン😃` | (a, b) | 数値 | max — 2つの値の大きい方 |
| `最小チャン😃` | (a, b) | 数値 | min — 2つの値の小さい方 |
| `ルートチャン😃` | (数値) | 小数 | sqrt — 平方根 |
| `ランダムチャン😃` | () | 小数 | 0.0〜1.0の乱数 |
| `ランダム範囲` | (min, max) | 整数 | min〜maxの範囲の乱数（両端含む） |

### 文字列操作

| 関数名 | 引数 | 戻り値 | 説明 |
|---|---|---|---|
| `分けてネ😘` | (文字列, 区切り) | 配列 | split — 文字列を分割 |
| `くっつけてネ😘` | (配列, 区切り) | 文字列 | join — 配列要素を連結 |
| `切り取ってネ😘` | (文字列, 開始, [終了]) | 文字列 | substring — 部分文字列抽出 |
| `置き換えてネ😘` | (文字列, 検索, 置換) | 文字列 | replace — 文字列置換 |
| `スッキリさせてネ😘` | (文字列) | 文字列 | trim — 前後の空白除去 |
| `デカくしてネ😘` | (文字列) | 文字列 | upper — ASCII大文字化 |
| `ちいさくしてネ😘` | (文字列) | 文字列 | lower — ASCII小文字化 |
| `どこにあるノ😃` | (文字列, 検索文字列) | 整数 | indexOf — 位置検索（-1で見つからない） |
| `先頭合ってるヨ😃` | (文字列, 接頭辞) | 真偽値 | startsWith — 前方一致判定 |
| `末尾合ってるヨ😃` | (文字列, 接尾辞) | 真偽値 | endsWith — 後方一致判定 |
| `含むカナ` | (文字列, 検索文字列) | 真偽値 | contains — 部分文字列の存在判定 |
| `繰り返してネ😘` | (文字列, 回数) | 文字列 | repeat — 文字列を繰り返す |
| `文字コード教えてヨ😃` | (文字列, 位置) | 整数 | charCodeAt — バイト値を返す |

### 配列操作

| 関数名 | 引数 | 戻り値 | 説明 |
|---|---|---|---|
| `最後を取ってネ😘` | (配列) | 値 | pop — 末尾要素を取り出す（配列を変更） |
| `最初を取ってネ😘` | (配列) | 値 | shift — 先頭要素を取り出す（配列を変更） |
| `切り出してネ😘` | (配列, 開始, [終了]) | 配列 | slice — 部分配列を返す |
| `並べ替えてネ😘` | (配列) | 配列 | sort — 昇順ソート（配列を変更） |
| `逆にしてネ😘` | (配列) | 配列 | reverse — 要素を反転（配列を変更） |
| `どこにいるノ😃` | (配列, 値) | 整数 | indexOf — 要素位置検索（-1で見つからない） |
| `消してネ😘` | (配列, インデックス) | 値 | remove — 指定位置の要素を削除して返す |

### 辞書操作

| 関数名 | 引数 | 戻り値 | 説明 |
|---|---|---|---|
| `キー一覧ダヨ😎` | (辞書) | 配列 | keys — キーの配列を返す |
| `値一覧ダヨ😎` | (辞書) | 配列 | values — 値の配列を返す |
| `持ってるヨ😃` | (辞書, キー) | 真偽値 | hasKey — キーの存在判定 |
| `消しちゃうネ😘` | (辞書, キー) | 真偽値 | delete — キーを削除（成功でマジ） |
| `合体させてネ😘` | (辞書1, 辞書2) | 辞書 | merge — 2つの辞書を結合（新しい辞書を返す） |

### ネットワーク（Windows専用）

| 関数名 | 引数 | 戻り値 | 説明 |
|---|---|---|---|
| `取ってきてネ😘` | (URL) | 文字列 | HTTP GET — レスポンスボディを返す |
| `送っちゃうネ😘` | (URL, ボディ) | 文字列 | HTTP POST — JSON送信、レスポンスボディを返す |
| `お届けモノだヨ😃` | (メソッド, URL, [ボディ], [ヘッダー辞書]) | 辞書 | 汎用HTTPリクエスト。戻り値: `《「status」→数値、「body」→文字列、「headers」→文字列》` |

#### HTTP使用例

```
（ココだけの話…GETリクエスト）
チョット聞いてヨ😃 結果チャンは 取ってきてネ😘チャンにオネガイ😃 「https://httpbin.org/get」 ナンダ😘
結果チャン オッハー❗

（ココだけの話…POSTリクエスト）
チョット聞いてヨ😃 応答チャンは 送っちゃうネ😘チャンにオネガイ😃 「https://httpbin.org/post」、「{"key":"value"}」 ナンダ😘
応答チャン オッハー❗

（ココだけの話…汎用リクエスト）
チョット聞いてヨ😃 結果チャンは お届けモノだヨ😃チャンにオネガイ😃 「GET」、「https://httpbin.org/get」 ナンダ😘
チョット聞いてヨ😃 ステータスチャンは 結果チャンの「status」番目チャン ナンダ😘
ステータスチャン オッハー❗
```

### 画面制御

| 関数名 | 引数 | 戻り値 | 説明 |
|---|---|---|---|
| `画面クリア` | () | ナイナイ | 画面をクリア |
| `カーソル上` | (行数) | ナイナイ | カーソルをN行上に移動 |
| `行クリア` | () | ナイナイ | 現在行をクリア |
| `カーソル移動` | (行, 列) | ナイナイ | カーソルを指定位置に移動 |
| `ちょっと待って` | (ミリ秒) | ナイナイ | 指定時間待機（sleep） |

### その他

| 関数名 | 引数 | 戻り値 | 説明 |
|---|---|---|---|
| `時計チャン` | () | 小数 | プログラム開始からの経過秒数 |

---

## 14. コメント

```
（ココだけの話…ここはコメントだヨ）
```

**構文:** `（ココだけの話…<テキスト>）`

複数行に渡るコメントも記述できます。

```
（ココだけの話…
    これは複数行の
    コメントだヨ
）
```

---

## 15. 文字列エスケープ

文字列リテラル `「...」` 内で使えるエスケープシーケンス:

| エスケープ | 意味 |
|---|---|
| `\n` | 改行 |
| `\t` | タブ |
| `\r` | キャリッジリターン |
| `\\` | バックスラッシュ |
| `\」` | 閉じ括弧（」をリテラルとして含める） |

---

## 付録: 完全なサンプルプログラム

### Hello World

```
「🍺 オッハー❗ おじさん言語の世界へようこそダヨ😃🍻」 オッハー❗
```

### FizzBuzz

```
iチャンが 1 から 30 まで関係あるんだけどサ😁
    もしかして😍 iチャン あまり 15 おなじカナ❓ 0 カナ❓
        「FizzBuzz🍻🎉」 オッハー❗
    ナンチャッテ😃 iチャン あまり 3 おなじカナ❓ 0 カナ❓
        「Fizz😘」 オッハー❗
    ナンチャッテ😃 iチャン あまり 5 おなじカナ❓ 0 カナ❓
        「Buzz🍺」 オッハー❗
    ソウジャナカッタラ😅
        iチャン オッハー❗
    オッケー👍
もういいカナ😤
```

### フィボナッチ数列（再帰）

```
fibチャンのやり方教えるネ😘 nチャン
    もしかして😍 nチャン 以下❗ 1 カナ❓
        コタエは nチャン ダヨ😁
    オッケー👍
    コタエは fibチャンにオネガイ😃 nチャン ひく 1 と fibチャンにオネガイ😃 nチャン ひく 2 ダヨ😁
やり方おしまい❗

iチャンが 0 から 20 まで関係あるんだけどサ😁
    チョット聞いてヨ😃 結果チャンは fibチャンにオネガイ😃 iチャン ナンダ😘
    「fib(」 と iチャン と 「) = 」 と 結果チャン オッハー❗
もういいカナ😤
```

### RPGクラス

```
キャラサンのコト教えるヨ😃
    ハジメマシテ😘 名前チャン、 HPチャン、 攻撃力チャン
        ボクの 名前チャンは 名前チャン ニナッチャッタ😅💦
        ボクの HPチャンは HPチャン ニナッチャッタ😅💦
        ボクの 攻撃力チャンは 攻撃力チャン ニナッチャッタ😅💦
    ハジメマシテおしまい❗

    自己紹介チャンのやり方教えるネ😘
        「名前: 」 と ボクの 名前チャン と 「 HP: 」 と ボクの HPチャン オッハー❗
    やり方おしまい❗
キャラサンのコトおしまい❗

チョット聞いてヨ😃 勇者チャンは キャラサンを作るヨ😃 「おじさん勇者」、 100、 25 ナンダ😘
勇者チャンの 自己紹介チャンにオネガイ😃
```

### HTTP通信

```
チョット聞いてヨ😃 結果チャンは 取ってきてネ😘チャンにオネガイ😃 「https://httpbin.org/get」 ナンダ😘
結果チャン オッハー❗
```
